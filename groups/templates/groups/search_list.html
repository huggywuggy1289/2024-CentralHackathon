<!-- templates/groups/search_list.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Search Results</title>
  </head>
  <body>
    <h1>ê·¸ë£¹ë¦¬ìŠ¤íŠ¸</h1>

    <!-- ê²€ìƒ‰ í¼ -->
    <div class="search">
      <form method="GET" action="{% url 'groups:search' %}">
        <input type="text" name="search" value="{{ search }}" placeholder="Search..." />
        <button type="submit" class="search-button">ğŸ’œ</button>
      </form>
    </div>

    <!-- ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ -->
    {% if groups %}
    <ul>
      {% for group in groups %}
      <li>
        <a href="{% url 'groups:group_detail' group.id %}">{{ group.name }}</a>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p>ê²€ìƒ‰ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endif %}
  </body>
</html>

{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>search_list_page</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/group_search.css' %}" />
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            min-height: 100vh;
            background-color: #efefef;
        }

        article {
            width: 430px;
            height: 1000px;
            background-color: #191919;
            border-radius: 10px;
            position: relative;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
    <article>
        <header>
            <a href="{% url 'main:main' %}">
                <div class="logo">
                    <img src="{% static 'img/base.html_logo.svg' %}" alt="ë¡œê³ ì´ë¯¸ì§€" />
                </div>
            </a>
            <div class="title_line">
                <div class="title">ê·¸ë£¹ ì°¾ê¸°</div>
            </div>
        </header>
        <section>
            <div class="search_box">
                <form method="GET" action="{% url 'groups:search' %}">
                    <input type="text" name="search" value="{{ search }}" placeholder="ê·¸ë£¹ëª…ìœ¼ë¡œ ê²€ìƒ‰" />
                    <input type="hidden" name="sort_by" id="sort_by_input" value="{{ sort_by }}">
                    <button type="submit">
                        <img src="{% static 'img/group_search.html_search.svg' %}" alt="ê²€ìƒ‰ì•„ì´ì½˜" />
                    </button>
                </form>
            </div>
            <div class="group-select">
                <p>ì •ë ¬ê¸°ì¤€</p>
                <div class="sort">
                    <form method="GET" action="{% url 'groups:search' %}">
                        <input type="hidden" name="search" value="{{ search }}">
                        <select name="sort_by" onchange="this.form.submit()">
                            <option value="ìµœì‹ ìˆœ" {% if sort_by == 'ìµœì‹ ìˆœ' %}selected{% endif %}>ìµœì‹ ìˆœ</option>
                            <option value="ì˜¤ë˜ëœìˆœ" {% if sort_by == 'ì˜¤ë˜ëœìˆœ' %}selected{% endif %}>ì˜¤ë˜ëœìˆœ</option>
                            <option value="ë‹¤ì¸ì›ìˆœ" {% if sort_by == 'ë‹¤ì¸ì›ìˆœ' %}selected{% endif %}>ë‹¤ì¸ì›ìˆœ</option>
                            <option value="ì†Œì¸ì›ìˆœ" {% if sort_by == 'ì†Œì¸ì›ìˆœ' %}selected{% endif %}>ì†Œì¸ì›ìˆœ</option>
                        </select>
                    </form>
                </div>
            </div>
            <div class="team_list">
                {% if groups %}
                    {% for group in groups %}
                    <a href="{% url 'groups:group_detail' group.id %}">
                        <div class="team_box">
                            <div class="team_name">{{ group.name }}</div>
                            <div class="team_info">
                                <div class="info_1"><span>ì¸ì›</span>{{ group.current_members }}/{{ group.max_members }}ëª…</div>
                                <div class="info_2"><span>ê·¸ë£¹ì¥</span>{{ group.author }}</div>
                                <div class="info_3"><span>ì‹œì‘ì¼</span>{{ group.created_at|date:"Y.m.d" }}</div>
                            </div>
                            <div class="team_intro">{{ group.introduce }}</div>
                        </div>
                    </a>
                    {% endfor %}
                {% else %}
                    <p>ê²€ìƒ‰ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                {% endif %}
            </div>
            <a href="{% url 'groups:group_create' %}">
                <div class="add_button">
                    <img src="{% static 'img/group_main.html_+button.svg' %}" alt="ì¶”ê°€ë²„íŠ¼" />
                </div>
            </a>
        </section>
        <footer>
            <div class="button_box">
              <a href="{% url 'main:main' %}">
                <button id="home"><img src="{% static 'img/base.html_home.svg' %}" alt="í™ˆí™”ë©´" /></button>
              </a>
              <a href="{% url 'groups:my_groups' %}">
                <button id="group"><img src="{% static 'img/base.html_group_active.svg' %}" alt="ê·¸ë£¹" /></button>
              </a>
              <a href="{% url 'main:notifications' %}">
                <button id="ball"><img src="{% static 'img/base.html_ball.svg' %}" alt="ì•Œë¦¼" /></button>
              </a>
              <a href="{% url 'accounts:mypage' %}">
                <button id="mypage"><img src="{% static 'img/base.html_mypage.svg' %}" alt="ë§ˆì´í˜ì´ì§€" /></button>
              </a>
            </div>
          </footer>
    </article>
    <script src="{% static 'js/group_search.js' %}"></script>
    <script>
        function setSortBy(value) {
            document.getElementById('sort_by_input').value = value;
            document.querySelector('form').submit();
        }

        // ì»¤ìŠ¤í…€ ì…€ë ‰íŠ¸ ë°•ìŠ¤ ìŠ¤í¬ë¦½íŠ¸
        var x, i, j, selElmnt, a, b, c;
        x = document.getElementsByClassName("custom-select");
        for (i = 0; i < x.length; i++) {
            selElmnt = x[i].getElementsByTagName("select")[0];
            a = document.createElement("DIV");
            a.setAttribute("class", "select-selected");
            a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
            x[i].appendChild(a);
            b = document.createElement("DIV");
            b.setAttribute("class", "select-items select-hide");
            for (j = 0; j < selElmnt.length; j++) {
                c = document.createElement("DIV");
                c.innerHTML = selElmnt.options[j].innerHTML;
                c.addEventListener("click", function(e) {
                    var y, i, k, s, h;
                    s = this.parentNode.parentNode.getElementsByTagName("select")[0];
                    h = this.parentNode.previousSibling;
                    for (i = 0; i < s.length; i++) {
                        if (s.options[i].innerHTML == this.innerHTML) {
                            s.selectedIndex = i;
                            h.innerHTML = this.innerHTML;
                            y = this.parentNode.getElementsByClassName("same-as-selected");
                            for (k = 0; k < y.length; k++) {
                                y[k].removeAttribute("class");
                            }
                            this.setAttribute("class", "same-as-selected");
                            break;
                        }
                    }
                    h.click();
                });
                b.appendChild(c);
            }
            x[i].appendChild(b);
            a.addEventListener("click", function(e) {
                e.stopPropagation();
                closeAllSelect(this);
                this.nextSibling.classList.toggle("select-hide");
                this.classList.toggle("select-arrow-active");
            });
        }
        function closeAllSelect(elmnt) {
            var x, y, i, arrNo = [];
            x = document.getElementsByClassName("select-items");
            y = document.getElementsByClassName("select-selected");
            for (i = 0; i < y.length; i++) {
                if (elmnt == y[i]) {
                    arrNo.push(i)
                } else {
                    y[i].classList.remove("select-arrow-active");
                }
            }
            for (i = 0; i < x.length; i++) {
                if (arrNo.indexOf(i)) {
                    x[i].classList.add("select-hide");
                }
            }
        }
        document.addEventListener("click", closeAllSelect);
    </script>
</body>
</html>
